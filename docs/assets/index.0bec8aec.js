var e;const t=/(\S+)\s(\d{4}\/\d{2}\/\d{2}\s\d{2}:\d{2}:\d{2})\r\n\s+(.*?)\s*\r\n/g;const n=/^进行([^(力量)(教育)(灵感)(智力)(体质)(幸运)(敏捷)(意志)(外貌)\s]+)检定.*?成功$/;const s=document.querySelector(".players");null==(e=document.querySelector("#logs"))||e.addEventListener("change",(async function(){if(!this.files||!this.files.length)return;const e=this.files[0];try{const r=await(c=e,new Promise((function(e,t){const n=new FileReader;n.onload=function(){e(this.result)},n.onerror=function(){t(this.error)},n.readAsText(c,o)})));if(!r)return void alert("空文件");const a=function(e){const n={};let s=null;for(;s=t.exec(e);){const[,e,t,c]=s;n[e]||(n[e]=[]),n[e].push({name:e,date:t,content:c})}return n}(r),l=Object.values(a).filter((e=>e.some((e=>n.test(e.content))))).map((function(e){return function(e,t){const n=document.createElement("div");n.classList.add("player-name"),n.textContent=e;const s=t.map((function(e){const t=document.createElement("div");return t.textContent=e,t})),c=document.createElement("div");c.classList.add("player-skills"),c.append(...s);const o=document.createElement("div");return o.classList.add("player"),o.append(n,c),o}(e[0].name,e.reduce((function(e,t){const s=n.exec(t.content);if(s){const[,t]=s;e.includes(t)||e.push(t)}return e}),[]))}));null==s||s.append(...l)}catch(r){console.error(r),alert("读取文件失败")}var c,o}));
